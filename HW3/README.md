Attached are the reinforcement learning controller for problem3 and problem4

Question3 use first visit on policy MonteCarlo method to solve it
Question4 is the design of data-driven controller based on policy iteration.

Attached pictures shows the number of iteration with the episodes growing. Both algothrim did 5000 trainings.
